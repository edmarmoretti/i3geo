<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: Randomly Shift a Line Segment Pattern</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for rshift.psp {spatstat}"><tr><td>rshift.psp {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Randomly Shift a Line Segment Pattern</h2>


<h3>Description</h3>

<p>
Randomly shifts the segments in a line segment pattern.
</p>


<h3>Usage</h3>

<pre>
   ## S3 method for class 'psp':
   rshift(X, ..., group=NULL, which=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
Line segment pattern to be subjected to a random shift.
An object of class <code>"psp"</code>.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Arguments controlling the randomisation and the handling of edge
effects. See <code><a href="rshift.ppp.html">rshift.ppp</a></code>.
</td></tr>
<tr valign="top"><td><code>group</code></td>
<td>
Optional. Factor specifying a grouping of the line segments of <code>X</code>,
or <code>NULL</code> indicating that all line segments belong to the same group.
Each group will be shifted together, and
separately from other groups.
</td></tr>
<tr valign="top"><td><code>which</code></td>
<td>
Optional. Identifies which groups of the pattern will be shifted,
while other groups are not shifted. A vector of levels of <code>group</code>.
</td></tr>
</table>

<h3>Details</h3>

<p>
This operation randomly shifts the locations of the line segments
in a line segment pattern.
</p>
<p>
The function <code>rshift</code> is generic. This function <code>rshift.psp</code>
is the method for line segment patterns.
</p>
<p>
The line segments of <code>X</code> are first divided into groups,
then the line segments within a group are shifted by a common
random displacement vector. Different groups of line segments are shifted
independently.
If the argument <code>group</code> is present, then this determines the grouping.
Otherwise, all line segments belong to a single group.
</p>
<p>
The argument <code>group</code> should be a factor, of length equal to the
number of line segments in <code>X</code>.
Alternatively <code>group</code> may be <code>NULL</code>,
which specifies that all line segments of <code>X</code> belong to a single group.
</p>
<p>
By default, every group of line segments will be shifted.
The argument <code>which</code> indicates that only some of the groups
should be shifted, while other groups should be left unchanged.
<code>which</code> must be a vector of levels of <code>group</code>
indicating which groups are to be shifted. 
</p>
<p>
The displacement vector, i.e. the vector
by which the data line segments are shifted,
is generated at random.
The <EM>default</EM> behaviour is 
to generate a displacement vector at random with equal probability
for all possible displacements. This means that the <i>x</i> and
<i>y</i> coordinates of the displacement vector are independent random
variables, uniformly distributed over the range of possible coordinates.
</p>
<p>
Alternatively, the displacement vector can be generated by
another random mechanism, controlled by the arguments
<code>radius</code>, <code>width</code> and <code>height</code>. 
<dl>
<dt>rectangular:</dt><dd>if <code>width</code> and <code>height</code> are given, then 
the displacement vector is uniformly distributed
in a rectangle of these dimensions, centred at
the origin.  The maximum possible displacement in the <i>x</i>
direction is <code>width/2</code>. The maximum possible displacement in
the <i>y</i> direction is <code>height/2</code>. The <i>x</i> and <i>y</i>
displacements are independent. (If <code>width</code> and <code>height</code>
are actually equal to the dimensions of the observation window,
then this is equivalent to the default.)
</dd>
<dt>radial:</dt><dd>if <code>radius</code> is given, then the displacement vector is
generated by choosing a random line segment inside a disc of
the given radius, centred at the origin, with uniform probability
density over the disc. Thus the argument <code>radius</code> determines
the maximum possible displacement distance.
The argument <code>radius</code> is incompatible with the
arguments <code>width</code> and <code>height</code>.
</dd>
</dl>

<p>
The argument <code>edge</code> controls what happens when 
a shifted line segment lies partially or completely
outside the window of <code>X</code>. Currently the only option is
<code>"erode"</code> which specifies that the segments will be clipped
to a smaller window. 
</p>
<p>
The optional argument <code>clip</code> specifies a smaller window
to which the pattern should be restricted.
</p>


<h3>Value</h3>

<p>
A line segment pattern (object of class <code>"psp"</code>).</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="rshift.html">rshift</a></code>,
<code><a href="rshift.ppp.html">rshift.ppp</a></code>
</p>


<h3>Examples</h3>

<pre>
  X &lt;- psp(runif(20), runif(20), runif(20), runif(20),  window=owin())
  Y &lt;- rshift(X, radius=0.1)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
