<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: Estimate the empty space function F</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for Fest {spatstat}"><tr><td>Fest {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Estimate the empty space function F</h2>


<h3>Description</h3>

<p>
Estimates the empty space function <i>F(r)</i> from a point pattern in a 
window of arbitrary shape.
</p>


<h3>Usage</h3>

<pre>
Fest(X, eps, r=NULL, breaks=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
The observed point pattern, 
from which an estimate of <i>F(r)</i> will be computed.
An object of class <code>ppp</code>, or data
in any format acceptable to <code><a href="as.ppp.html">as.ppp</a>()</code>.
</td></tr>
<tr valign="top"><td><code>eps</code></td>
<td>
Optional. A positive number.
The resolution of the discrete approximation to Euclidean
distance (see below). There is a sensible default.
</td></tr>
<tr valign="top"><td><code>r</code></td>
<td>
Optional. Numeric vector. The values of the argument <i>r</i>
at which <i>F(r)</i> should be evaluated. There is a sensible default.
First-time users are strongly advised not to specify this argument.
See below for important conditions on <i>r</i>.
</td></tr>
<tr valign="top"><td><code>breaks</code></td>
<td>
An alternative to the argument <code>r</code>.
Not normally invoked by the user. See the <B>Details</B> section.
</td></tr>
</table>

<h3>Details</h3>

<p>
The empty space function 
(also called the ``<EM>spherical contact distribution</EM>''
or the ``<EM>point-to-nearest-event</EM>'' distribution)
of a stationary point process <i>X</i>
is the cumulative distribution function <i>F</i> of the distance
from a fixed point in space to the nearest point of <i>X</i>.
</p>
<p>
An estimate of <i>F</i> derived from a spatial point pattern dataset
can be used in exploratory data analysis and formal inference
about the pattern (Cressie, 1991; Diggle, 1983; Ripley, 1988).
In exploratory analyses, the estimate of <i>F</i> is a useful statistic 
summarising the sizes of gaps in the pattern.
For inferential purposes, the estimate of <i>F</i> is usually compared to the 
true value of <i>F</i> for a completely random (Poisson) point process,
which is
</p><p align="center"><i>F(r) = 1 - exp( - lambda * pi * r^2)      
</i></p><p>
where <i>lambda</i>
is the intensity (expected number of points per unit area).
Deviations between the empirical and theoretical <i>F</i> curves
may suggest spatial clustering or spatial regularity.
</p>
<p>
This algorithm estimates the empty space function <i>F</i> 
from the point pattern <code>X</code>. It assumes that <code>X</code> can be treated
as a realisation of a stationary (spatially homogeneous) 
random spatial point process in the plane, observed through
a bounded window. 
The window (which is specified in <code>X</code>) may have arbitrary shape. 
</p>
<p>
The argument <code>X</code> is interpreted as a point pattern object 
(of class <code>"ppp"</code>, see <code><a href="ppp.object.html">ppp.object</a></code>) and can
be supplied in any of the formats recognised
by <code><a href="as.ppp.html">as.ppp</a></code>.
</p>
<p>
The algorithm uses two discrete approximations which are controlled
by the parameter <code>eps</code> and by the spacing of values of <code>r</code>
respectively. (See below for details.)
First-time users are strongly advised not to specify these arguments.
</p>
<p>
The estimation of <i>F</i> is hampered by edge effects arising from 
the unobservability of points of the random pattern outside the window. 
An edge correction is needed to reduce bias (Baddeley, 1998; Ripley, 1988). 
The two edge corrections implemented here are the border method or
"<EM>reduced sample</EM>" estimator, and the spatial Kaplan-Meier estimator
(Baddeley and Gill, 1997). 
</p>
<p>
Our implementation makes essential use of the distance transform algorithm
of image processing (Borgefors, 1986). A fine grid of pixels is 
created in the observation window. The Euclidean distance between two pixels
is approximated by the length of the shortest path joining them in the grid,
where a path is a sequence of steps between adjacent pixels, and 
horizontal, vertical and diagonal steps have length
<i>1</i>, <i>1</i> and <i>sqrt(2)</i>
respectively in pixel units. If the pixel grid is sufficiently fine then
this is an accurate approximation. 
</p>
<p>
The parameter <code>eps</code>
is the pixel width of the rectangular raster
used to compute the distance transform (see below). It must not be too
large: the absolute error in distance values due to discretisation is bounded
by <code>eps</code>.
</p>
<p>
If <code>eps</code> is not specified, the function
checks whether the window <code>X$window</code> contains pixel raster
information. If so, then <code>eps</code> is set equal to the 
pixel width of the raster; otherwise, <code>eps</code>
defaults to 1/100 of the width of the observation window.
</p>
<p>
The argument <code>r</code> is the vector of values for the
distance <i>r</i> at which <i>F(r)</i> should be evaluated. 
It is also used to determine the breakpoints
(in the sense of <code><a href="../../graphics/html/hist.html">hist</a></code>
for the computation of histograms of distances. The reduced-sample and
Kaplan-Meier estimators are computed from histogram counts. 
In the case of the Kaplan-Meier estimator this introduces a discretisation
error which is controlled by the fineness of the breakpoints.
</p>
<p>
First-time users would be strongly advised not to specify <code>r</code>.
However, if it is specified, <code>r</code> must satisfy <code>r[1] = 0</code>, 
and <code>max(r)</code> must be larger than the radius of the largest disc 
contained in the window. Furthermore, the spacing of successive
<code>r</code> values must be very fine (ideally not greater than <code>eps/4</code>).
</p>
<p>
The algorithm also returns an estimate of the hazard rate function, 
<i>lambda(r)</i>, of <i>F(r)</i>. The hazard rate is
defined by
</p><p align="center"><i>lambda(r) = - (d/dr) log(1 - F(r)) 
</i></p><p>
The hazard rate of <i>F</i> has been proposed as a useful
exploratory statistic (Baddeley and Gill, 1994).
The estimate of <i>lambda(r)</i> given here
is a discrete approximation to the hazard rate of the 
Kaplan-Meier estimator of <i>F</i>. Note that <i>F</i> is 
absolutely continuous (for any stationary point process <i>X</i>), 
so the hazard function always exists (Baddeley and Gill, 1997). 
</p>
<p>
The naive empirical distribution of distances from each location
in the window to the nearest point of the data pattern, is a biased
estimate of <i>F</i>. However this is also returned by the algorithm,
as it is sometimes useful in other contexts.
Care should be taken not to use the uncorrected
empirical <i>F</i> as if it were an unbiased estimator of <i>F</i>.
</p>


<h3>Value</h3>

<p>
An object of class <code>"fv"</code>, see <code><a href="fv.object.html">fv.object</a></code>,
which can be plotted directly using <code><a href="plot.fv.html">plot.fv</a></code>.
<br>
Essentially a data frame containing six columns:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>r</code></td>
<td>
the values of the argument <i>r</i> 
at which the function <i>F(r)</i> has been  estimated
</td></tr>
<tr valign="top"><td><code>rs</code></td>
<td>
the ``reduced sample'' or ``border correction''
estimator of <i>F(r)</i>
</td></tr>
<tr valign="top"><td><code>km</code></td>
<td>
the spatial Kaplan-Meier estimator of <i>F(r)</i>
</td></tr>
<tr valign="top"><td><code>hazard</code></td>
<td>
the hazard rate <i>lambda(r)</i>
of <i>F(r)</i> by the spatial Kaplan-Meier method
</td></tr>
<tr valign="top"><td><code>raw</code></td>
<td>
the uncorrected estimate of <i>F(r)</i>,
i.e. the empirical distribution of the distance from 
a random point in the window to the nearest point of
the data pattern <code>X</code>
</td></tr>
<tr valign="top"><td><code>theo</code></td>
<td>
the theoretical value of <i>F(r)</i>
for a stationary Poisson process of the same estimated intensity.
</td></tr>
</table>

<h3>Warnings</h3>

<p>
The reduced sample (border method)
estimator of <i>F</i> is pointwise approximately 
unbiased, but need not be a valid distribution function; it may 
not be a nondecreasing function of <i>r</i>. Its range is always 
within <i>[0,1]</i>.
</p>
<p>
The spatial Kaplan-Meier estimator of <i>F</i> is always nondecreasing
but its maximum value may be less than <i>1</i>.
</p>
<p>
The estimate of <i>lambda(r)</i>
returned by the algorithm is an approximately
unbiased estimate for the integral of <i>lambda()</i>
over the corresponding histogram cell.
It may exhibit oscillations due to discretisation effects.
We recommend modest smoothing, such as kernel smoothing with 
kernel width equal to the width of a histogram cell.
</p>


<h3>Note</h3>

<p>
Sizeable amounts of memory may be needed during the calculation.
</p>


<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>References</h3>

<p>
Baddeley, A.J. Spatial sampling and censoring.
In O.E. Barndorff-Nielsen, W.S. Kendall and
M.N.M. van Lieshout (eds) 
<EM>Stochastic Geometry: Likelihood and Computation</EM>.
Chapman and Hall, 1998.
Chapter 2, pages 37-78.
</p>
<p>
Baddeley, A.J. and Gill, R.D. 
The empty space hazard of a spatial pattern.
Research Report 1994/3, Department of Mathematics,
University of Western Australia, May 1994.
</p>
<p>
Baddeley, A.J. and Gill, R.D.
Kaplan-Meier estimators of interpoint distance
distributions for spatial point processes.
<EM>Annals of Statistics</EM> <B>25</B> (1997) 263-292.
</p>
<p>
Borgefors, G.
Distance transformations in digital images.
<EM>Computer Vision, Graphics and Image Processing</EM>
<B>34</B> (1986) 344-371.
</p>
<p>
Cressie, N.A.C. <EM>Statistics for spatial data</EM>.
John Wiley and Sons, 1991.
</p>
<p>
Diggle, P.J. <EM>Statistical analysis of spatial point patterns</EM>.
Academic Press, 1983.
</p>
<p>
Ripley, B.D. <EM>Statistical inference for spatial processes</EM>.
Cambridge University Press, 1988.
</p>
<p>
Stoyan, D, Kendall, W.S. and Mecke, J.
<EM>Stochastic geometry and its applications</EM>.
2nd edition. Springer Verlag, 1995.
</p>


<h3>See Also</h3>

<p>
<code><a href="Gest.html">Gest</a></code>,
<code><a href="Jest.html">Jest</a></code>,
<code><a href="Kest.html">Kest</a></code>,
<code><a href="km.rs.html">km.rs</a></code>,
<code><a href="reduced.sample.html">reduced.sample</a></code>,
<code><a href="kaplan.meier.html">kaplan.meier</a></code>
</p>


<h3>Examples</h3>

<pre>
   data(cells)
   Fc &lt;- Fest(cells, 0.01)

   # Tip: don't use F for the left hand side!
   # That's an abbreviation for FALSE

   plot(Fc)

   # P-P style plot
   plot(Fc, cbind(km, theo) ~ theo)

   # The empirical F is above the Poisson F
   # indicating an inhibited pattern

   ## Not run: 
   plot(Fc, . ~ theo)
   plot(Fc, asin(sqrt(.)) ~ asin(sqrt(theo)))
   
## End(Not run)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
